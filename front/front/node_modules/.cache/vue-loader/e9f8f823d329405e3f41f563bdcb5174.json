{"remainingRequest":"/home/yallakora/front/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/yallakora/front/front/src/components/VideoPlayer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/yallakora/front/front/src/components/VideoPlayer.vue","mtime":1652010325925},{"path":"/home/yallakora/front/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/yallakora/front/front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAndmlkZW8uanMvZGlzdC92aWRlby1qcy5jc3MnCmltcG9ydCBfdmlkZW9qcyBmcm9tICd2aWRlby5qcycKY29uc3QgdmlkZW9qcyA9IHdpbmRvdy52aWRlb2pzIHx8IF92aWRlb2pzCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1ZpZGVvUGxheWVyJywKICBwcm9wczogewogICAgY3Jvc3NPcmlnaW46IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnYW5vbnltb3VzJwogICAgICAvLyBkZWZhdWx0OiAndXNlLWNyZWRlbnRpYWxzJwogICAgfSwKICAgIHBsYXlzaW5saW5lOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgY3VzdG9tRXZlbnROYW1lOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ3N0YXRlY2hhbmdlZCcKICAgIH0sCiAgICBvcHRpb25zOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICBldmVudHM6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQ6ICgpID0+IFtdCiAgICB9LAogICAgZ2xvYmFsT3B0aW9uczogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+ICh7CiAgICAgICAgLy8gZG9jdW1lbnQ6IGh0dHBzOi8vZG9jcy52aWRlb2pzLmNvbS90dXRvcmlhbC1vcHRpb25zLmh0bWwjZmx1aWQKICAgICAgICBhdXRvcGxheTogdHJ1ZSwKICAgICAgICBjb250cm9sczogdHJ1ZSwKICAgICAgICBsYW5ndWFnZTogJ3poJywKICAgICAgICBpbmFjdGl2aXR5VGltZW91dDogMCwKICAgICAgICBwcmVsb2FkOiAnYXV0bycsCiAgICAgICAgZmx1aWQ6IGZhbHNlLAogICAgICAgIHRlY2hPcmRlcjogWydodG1sNSddLAogICAgICAgIHBsdWdpbnM6IHt9CiAgICAgIH0pCiAgICB9LAogICAgZ2xvYmFsRXZlbnRzOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0OiAoKSA9PiBbXQogICAgfSwKICAgIHRyYWNrTGlzdDogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogKCkgPT4gW10KICAgIH0KICB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgcGxheWVyOiBudWxsLAogICAgICByZXNldGVkOiB0cnVlCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0aWFsaXplOiBmdW5jdGlvbiAoKSB7CiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzCiAgICAgIGNvbnN0IHZpZGVvT2JqID0gdGhpcy4kcmVmcy52aWRlbwogICAgICAvLyB2aWRlb2pzIG9wdGlvbnMKICAgICAgY29uc3QgdmlkZW9PcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5nbG9iYWxPcHRpb25zLCB0aGlzLm9wdGlvbnMpCiAgICAgIC8vIGlvcyBmdWxsc2NyZWVuCiAgICAgIGlmICh0aGlzLnBsYXlzaW5saW5lKSB7CiAgICAgICAgdmlkZW9PYmouc2V0QXR0cmlidXRlKCdwbGF5c2lubGluZScsIHRoaXMucGxheXNpbmxpbmUpCiAgICAgICAgdmlkZW9PYmouc2V0QXR0cmlidXRlKCd3ZWJraXQtcGxheXNpbmxpbmUnLCB0aGlzLnBsYXlzaW5saW5lKQogICAgICAgIHZpZGVvT2JqLnNldEF0dHJpYnV0ZSgneDUtcGxheXNpbmxpbmUnLCB0aGlzLnBsYXlzaW5saW5lKQogICAgICAgIHZpZGVvT2JqLnNldEF0dHJpYnV0ZSgneDUtdmlkZW8tcGxheWVyLXR5cGUnLCAnaDUnKQogICAgICAgIHZpZGVvT2JqLnNldEF0dHJpYnV0ZSgneDUtdmlkZW8tcGxheWVyLWZ1bGxzY3JlZW4nLCBmYWxzZSkKICAgICAgfQogICAgICAvLyBjcm9zcyBvcmlnaW4KICAgICAgaWYgKHRoaXMuY3Jvc3NPcmlnaW4gIT09ICcnKSB7CiAgICAgICAgdmlkZW9PYmouY3Jvc3NPcmlnaW4gPSB0aGlzLmNyb3NzT3JpZ2luCiAgICAgICAgdmlkZW9PYmouc2V0QXR0cmlidXRlKCdjcm9zc09yaWdpbicsIHRoaXMuY3Jvc3NPcmlnaW4pCiAgICAgICAgY29uc29sZS5sb2coJ2Nyb3NzT3JpZ2luIGNyb3NzT3JpZ2luIGNyb3NzT3JpZ2luJyk7CiAgICAgIH0gCiAgICAgIC8vIGVsc2UgewogICAgICAvLyAgIGNvbnNvbGUubG9nKCdjcm9zc09yaWdpbjIgY3Jvc3NPcmlnaW4yIGNyb3NzT3JpZ2luMicpOwogICAgICAgIAogICAgICAvLyB9CiAgICAgIC8vIGF2b2lkIGVycm9yICJWSURFT0pTOiBFUlJPUjogVW5hYmxlIHRvIGZpbmQgcGx1Z2luOiBfX29iX18iCiAgICAgIGlmICh2aWRlb09wdGlvbnMucGx1Z2lucykgewogICAgICAgIGRlbGV0ZSB2aWRlb09wdGlvbnMucGx1Z2lucy5fX29iX18KICAgICAgfQogICAgICAvLyBlbWl0IGV2ZW50CiAgICAgIGNvbnN0IGVtaXRQbGF5ZXJTdGF0ZSA9IChldmVudCwgdmFsdWUpID0+IHsKICAgICAgICBpZiAoZXZlbnQpIHsKICAgICAgICAgIHRoaXMuJGVtaXQoZXZlbnQsIHRoaXMucGxheWVyKQogICAgICAgIH0KICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgIHRoaXMuJGVtaXQodGhpcy5jdXN0b21FdmVudE5hbWUsIHsgW2V2ZW50XTogdmFsdWUgfSkKICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gcGxheWVyCiAgICAgIHRoaXMucGxheWVyID0gdmlkZW9qcyh2aWRlb09iaiwgdmlkZW9PcHRpb25zLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gZXZlbnRzCiAgICAgICAgY29uc3QgREVGQVVMVF9FVkVOVFMgPSBbCiAgICAgICAgICAnbG9hZGVkZGF0YScsCiAgICAgICAgICAnY2FucGxheScsCiAgICAgICAgICAnY2FucGxheXRocm91Z2gnLAogICAgICAgICAgJ3BsYXknLAogICAgICAgICAgJ3BhdXNlJywKICAgICAgICAgICd3YWl0aW5nJywKICAgICAgICAgICdwbGF5aW5nJywKICAgICAgICAgICdlbmRlZCcsCiAgICAgICAgICAnZXJyb3InCiAgICAgICAgXQogICAgICAgIGNvbnN0IGV2ZW50cyA9IERFRkFVTFRfRVZFTlRTLmNvbmNhdChzZWxmLmV2ZW50cykuY29uY2F0KAogICAgICAgICAgc2VsZi5nbG9iYWxFdmVudHMKICAgICAgICApCgogICAgICAgIC8vIHdhdGNoIGV2ZW50cwogICAgICAgIGNvbnN0IG9uRWRFdmVudHMgPSB7fQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIHR5cGVvZiBldmVudHNbaV0gPT09ICdzdHJpbmcnICYmCiAgICAgICAgICAgICAgb25FZEV2ZW50c1tldmVudHNbaV1dID09PSB1bmRlZmluZWQKICAgICAgICAgICkgewogICAgICAgICAgICAoZXZlbnQgPT4gewogICAgICAgICAgICAgIG9uRWRFdmVudHNbZXZlbnRdID0gbnVsbAogICAgICAgICAgICAgIHRoaXMub24oZXZlbnQsICgpID0+IHsKICAgICAgICAgICAgICAgIGVtaXRQbGF5ZXJTdGF0ZShldmVudCwgdHJ1ZSkKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KShldmVudHNbaV0pCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIHBsYXllciByZWFkaWVkCiAgICAgICAgc2VsZi4kZW1pdCgncmVhZHknLCB0aGlzKQogICAgICB9KQogICAgfSwKICAgIGRpc3Bvc2UgKGNhbGxiYWNrKSB7CiAgICAgIGlmICh0aGlzLnBsYXllciAmJiB0aGlzLnBsYXllci5kaXNwb3NlKSB7CiAgICAgICAgaWYgKHRoaXMucGxheWVyLnRlY2hOYW1lXyAhPT0gJ0ZsYXNoJykgewogICAgICAgICAgdGhpcy5wbGF5ZXIucGF1c2UgJiYgdGhpcy5wbGF5ZXIucGF1c2UoKQogICAgICAgIH0KICAgICAgICB0aGlzLnBsYXllci5kaXNwb3NlKCkKICAgICAgICB0aGlzLnBsYXllciA9IG51bGwKICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICB0aGlzLnJlc2V0ZWQgPSBmYWxzZQogICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgICB0aGlzLnJlc2V0ZWQgPSB0cnVlCiAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjaygpCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9KQogICAgICAgIH0pCiAgICAgIH0KICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBvcHRpb25zOiB7CiAgICAgIGRlZXA6IHRydWUsCiAgICAgIGhhbmRsZXIgKG9wdGlvbnMsIG9sZE9wdGlvbnMpIHsKICAgICAgICB0aGlzLmRpc3Bvc2UoKCkgPT4gewogICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5zb3VyY2VzICYmIG9wdGlvbnMuc291cmNlcy5sZW5ndGgpIHsKICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplKCkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkICgpIHsKICAgIGlmICghdGhpcy5wbGF5ZXIpIHsKICAgICAgdGhpcy5pbml0aWFsaXplKCkKICAgIH0KICB9LAogIGJlZm9yZURlc3Ryb3kgKCkgewogICAgaWYgKHRoaXMucGxheWVyKSB7CiAgICAgIHRoaXMuZGlzcG9zZSgpCiAgICB9CiAgfQp9Cgo="},{"version":3,"sources":["VideoPlayer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"VideoPlayer.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div  v-if=\"reseted\">\n    <video class=\"video-js\" ref=\"video\">\n      <track v-for=\"(crtTrack,index) in trackList\"\n             :key=\"index\"\n             :kind=\"crtTrack.kind\" :label=\"crtTrack.label\"\n             :src=\"crtTrack.src\" :srcLang=\"crtTrack.srcLang\"\n             :default=\"crtTrack.default\"/>\n      <p class=\"vjs-no-js\">\n        To view this video please enable JavaScript, and consider upgrading to a web browser that\n        <a href=\"https://videojs.com/html5-video-support/\" target=\"_blank\">supports HTML5 video</a>\n      </p>\n    </video>\n  </div>\n</template>\n\n<script>\nimport 'video.js/dist/video-js.css'\nimport _videojs from 'video.js'\nconst videojs = window.videojs || _videojs\n\nexport default {\n  name: 'VideoPlayer',\n  props: {\n    crossOrigin: {\n      type: String,\n      default: 'anonymous'\n      // default: 'use-credentials'\n    },\n    playsinline: {\n      type: Boolean,\n      default: false\n    },\n    customEventName: {\n      type: String,\n      default: 'statechanged'\n    },\n    options: {\n      type: Object,\n      required: true\n    },\n    events: {\n      type: Array,\n      default: () => []\n    },\n    globalOptions: {\n      type: Object,\n      default: () => ({\n        // document: https://docs.videojs.com/tutorial-options.html#fluid\n        autoplay: true,\n        controls: true,\n        language: 'zh',\n        inactivityTimeout: 0,\n        preload: 'auto',\n        fluid: false,\n        techOrder: ['html5'],\n        plugins: {}\n      })\n    },\n    globalEvents: {\n      type: Array,\n      default: () => []\n    },\n    trackList: {\n      type: Array,\n      default: () => []\n    }\n  },\n  data () {\n    return {\n      player: null,\n      reseted: true\n    }\n  },\n  methods: {\n    initialize: function () {\n      const self = this\n      const videoObj = this.$refs.video\n      // videojs options\n      const videoOptions = Object.assign({}, this.globalOptions, this.options)\n      // ios fullscreen\n      if (this.playsinline) {\n        videoObj.setAttribute('playsinline', this.playsinline)\n        videoObj.setAttribute('webkit-playsinline', this.playsinline)\n        videoObj.setAttribute('x5-playsinline', this.playsinline)\n        videoObj.setAttribute('x5-video-player-type', 'h5')\n        videoObj.setAttribute('x5-video-player-fullscreen', false)\n      }\n      // cross origin\n      if (this.crossOrigin !== '') {\n        videoObj.crossOrigin = this.crossOrigin\n        videoObj.setAttribute('crossOrigin', this.crossOrigin)\n        console.log('crossOrigin crossOrigin crossOrigin');\n      } \n      // else {\n      //   console.log('crossOrigin2 crossOrigin2 crossOrigin2');\n        \n      // }\n      // avoid error \"VIDEOJS: ERROR: Unable to find plugin: __ob__\"\n      if (videoOptions.plugins) {\n        delete videoOptions.plugins.__ob__\n      }\n      // emit event\n      const emitPlayerState = (event, value) => {\n        if (event) {\n          this.$emit(event, this.player)\n        }\n        if (value) {\n          this.$emit(this.customEventName, { [event]: value })\n        }\n      }\n      // player\n      this.player = videojs(videoObj, videoOptions, function () {\n        // events\n        const DEFAULT_EVENTS = [\n          'loadeddata',\n          'canplay',\n          'canplaythrough',\n          'play',\n          'pause',\n          'waiting',\n          'playing',\n          'ended',\n          'error'\n        ]\n        const events = DEFAULT_EVENTS.concat(self.events).concat(\n          self.globalEvents\n        )\n\n        // watch events\n        const onEdEvents = {}\n        for (let i = 0; i < events.length; i++) {\n          if (\n            typeof events[i] === 'string' &&\n              onEdEvents[events[i]] === undefined\n          ) {\n            (event => {\n              onEdEvents[event] = null\n              this.on(event, () => {\n                emitPlayerState(event, true)\n              })\n            })(events[i])\n          }\n        }\n        // player readied\n        self.$emit('ready', this)\n      })\n    },\n    dispose (callback) {\n      if (this.player && this.player.dispose) {\n        if (this.player.techName_ !== 'Flash') {\n          this.player.pause && this.player.pause()\n        }\n        this.player.dispose()\n        this.player = null\n        this.$nextTick(() => {\n          this.reseted = false\n          this.$nextTick(() => {\n            this.reseted = true\n            this.$nextTick(() => {\n              callback && callback()\n            })\n          })\n        })\n      }\n    }\n  },\n  watch: {\n    options: {\n      deep: true,\n      handler (options, oldOptions) {\n        this.dispose(() => {\n          if (options && options.sources && options.sources.length) {\n            this.initialize()\n          }\n        })\n      }\n    }\n  },\n  mounted () {\n    if (!this.player) {\n      this.initialize()\n    }\n  },\n  beforeDestroy () {\n    if (this.player) {\n      this.dispose()\n    }\n  }\n}\n\n</script>\n\n<style scoped>\n\n</style>\n"]}]}